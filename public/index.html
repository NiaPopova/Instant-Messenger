<!DOCTYPE html>
<html>
<head>
  <title>Messenger Auth Test</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    form { margin-bottom: 20px; }
    input { display: block; margin-bottom: 10px; padding: 8px; width: 300px; }
    button { padding: 8px 16px; }
    #response { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

  <h2>Register</h2>
  <form id="registerForm">
    <input type="text" id="regUser" placeholder="Username" required minlength="4" maxlength="20" />
    <input type="password" id="regPass" placeholder="Password" required minlength="6" maxlength="30" />
    <input type="email" id="regEmail" placeholder="Email" required />
    <input type="text" id="regName" placeholder="Full Name" required minlength="3" maxlength="50" />
    <button type="submit">Register</button>
  </form>

  <h2>Login</h2>
  <form id="loginForm">
    <input type="text" id="logUser" placeholder="Username" required />
    <input type="password" id="logPass" placeholder="Password" required />
    <button type="submit">Login</button>
  </form>

  <p id="response"></p>

  <script>
    const registerForm = document.getElementById('registerForm');
    const loginForm = document.getElementById('loginForm');
    const responseText = document.getElementById('response');

    registerForm.onsubmit = async (e) => {
      e.preventDefault();
      const res = await fetch('/auth/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          username: document.getElementById('regUser').value,
          password: document.getElementById('regPass').value,
          email: document.getElementById('regEmail').value,
          name: document.getElementById('regName').value
        })
      });
      const data = await res.json();
      responseText.innerText = `Register: ${data.message}`;
    };

    loginForm.onsubmit = async (e) => {
  e.preventDefault();
  const res = await fetch('/auth/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      username: document.getElementById('logUser').value,
      password: document.getElementById('logPass').value
    })
  });

  const data = await res.json();

  if (res.ok) {
    localStorage.setItem('username', document.getElementById('logUser').value);
    window.location.href = "/profile_page.html";
  } else {
    responseText.innerText = `Login: ${data.message}`;
  }
};
  </script>

</body>
</html>